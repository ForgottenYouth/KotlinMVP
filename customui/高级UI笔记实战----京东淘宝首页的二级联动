京东淘宝首页二级联动怎么实现？
2020-07-09 周四 20:00-22:00

1、引用androidx 的swiperefreshlayout的包
```aidl
implementation("androidx.swiperefreshlayout:swiperefreshlayout:1.1.0")
```
2、view 与viewgroup的关系
    从运行时的角度，viewgroup 是view的父亲
    从代码角度，view是viewgroup的父类
    
3、事件分发的流程
    dispatch , onTouch
4、嵌套滑动

    ScrollView ,NestedScrollView
   两个角色：父亲  需要实现：NestedScrollingParent3
            孩子  需要实现NestedScrollingChild
            
   滑动冲突的解决方案：内部拦截，外部拦截             


滑动的类型： 一是手指滑动  touch
            二是惯性滑动  non_touch
            
 
事件分发的流程
           
当我们的view 调用了requestDisallowInterceptTouchEvent(boolean disallowIntercept) 后，在viewGroup的该方法中
```java
 public void requestDisallowInterceptTouchEvent(boolean disallowIntercept) {

        if (disallowIntercept == ((mGroupFlags & FLAG_DISALLOW_INTERCEPT) != 0)) {
            // We're already in this state, assume our ancestors are too
            return;
        }

        if (disallowIntercept) {
            mGroupFlags |= FLAG_DISALLOW_INTERCEPT;
        } else {
            mGroupFlags &= ~FLAG_DISALLOW_INTERCEPT;
        }

        // Pass it up to our parent
        if (mParent != null) {
            mParent.requestDisallowInterceptTouchEvent(disallowIntercept);
        }
    }
```
这样依次来通知他的parent不要拦截事件


通过Layout Inspector来分析我们当前运行的activity时，发现根布局则是FrameLayout ，而FrameLayout是ViewGroup的子类
那么我们就从ViewGroup的来进行事件分发：
进入ViewGroup的dispatchTouchEvent(MotionEvent ev)方法中
1）
```java
            // Check for interception.
            final boolean intercepted;
            if (actionMasked == MotionEvent.ACTION_DOWN
                    || mFirstTouchTarget != null) {
                final boolean disallowIntercept = (mGroupFlags & FLAG_DISALLOW_INTERCEPT) != 0;
                if (!disallowIntercept) {
                    intercepted = onInterceptTouchEvent(ev);
                    ev.setAction(action); // restore action in case it was changed
                } else {
                    intercepted = false;
                }
            } else {
                // There are no touch targets and this action is not an initial down
                // so this view group continues to intercept touches.
                intercepted = true;
            }
```
